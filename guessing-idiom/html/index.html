<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        #content{
            position: relative;
        }
        #content div.item {
            position: absolute;
            padding-top: 4px;
            padding-left: 7px;
        }
        div.bg-line {
            width: 100%;
            float: left;
        }
        div.bg-normal {
            width: 28px;
            height: 28px;
            border-color: red;
            border-style: solid;
            border-width: 1px;
            float: left;
        }
        #result{
            margin-top: 20px;
        }
        #result div.item {
            float:left;
            margin-right: 20px;
        }
        .clean{
            clear:both;
        }
    </style>
</head>
<body>
    <div id="content" >
        <div id="background">
        </div>
    </div>
    <div id="result">
    </div>
<script>

    const SIZE = 8 ;
    const SPAN = 30 ;
    let test = '[{"idiom":"苦思冥想","mean":"绞尽脑汁，深沉地思索。","pos":"3,6;4,6;5,6;6,6","vis":"1101"},{"idiom":"不辞劳苦","mean":"辞：推托。劳苦：劳累辛苦。不逃避劳累辛苦。形容人不怕吃苦，毅力强。","pos":"3,3;3,4;3,5;3,6","vis":"1101"},{"idiom":"迟疑不定","mean":"犹言迟疑不决。","pos":"1,3;2,3;3,3;4,3","vis":"1101"},{"idiom":"迟疑不决","mean":"形容拿不定主意。","pos":"1,3;1,4;1,5;1,6","vis":"1101"},{"idiom":"事不宜迟","mean":"事情要抓紧时机快做，不宜拖延。","pos":"1,0;1,1;1,2;1,3","vis":"1101"},{"idiom":"临事而惧","mean":"临：遭遇，碰到；惧：或惧。遇事谨慎戒惧。","pos":"0,0;1,0;2,0;3,0","vis":"0111"},{"idiom":"临深履薄","mean":"面临深渊，脚踩薄冰。比喻小心谨慎，惟恐有失。","pos":"0,0;0,1;0,2;0,3","vis":"1101"}]' ;
    let testList = JSON.parse(test) ;

    createBackground(SIZE) ;
    let results = createPlayground(SPAN, testList) ;
    console.log("results : ", results) ;
    renderResults(results) ;

    function renderResults(results) {
        let parentEle = document.getElementById("result") ;
        for (let i in results) {
            let ele = document.createElement("div") ;
            ele.setAttribute("class", "item") ;
            ele.append(results[i]) ;

            parentEle.appendChild(ele) ;
        }

        appendClean(parentEle)
    }

    function appendClean(ele) {
        let clEle = document.createElement("div") ;
        clEle.setAttribute("class", "clean") ;
        ele.appendChild(clEle) ;
    }

    function createBackground(size) {
        let bgEle = document.getElementById("background") ;
        for (let i=0; i<size; i++) {
            let eleRow = document.createElement("div") ;
            eleRow.setAttribute("class", "bg-line") ;

            for (let j=0; j<size; j++) {
                let eleColl = document.createElement("div") ;
                eleColl.setAttribute("class", "bg-normal") ;

                eleRow.appendChild(eleColl) ;
            }

            bgEle.appendChild(eleRow) ;

            // let clEle = document.createElement("div") ;
            // clEle.setAttribute("class", "clean") ;
            // bgEle.appendChild(clEle) ;
            appendClean(bgEle) ;
        }
    }

    function createPlayground(span, data) {
        let results = [] ;

        for (let i in data) {
            let item = data[i] ;
            let poses = item["pos"].split(";") ;

            for (let j=0,c=item["idiom"].length; j<c; j++) {
                let pos = poses.shift() ;
                let posObj = pos.split(",") ;
                let resultsKey = `${posObj[1]}-${posObj[0]}` ;
                if (item["vis"][j]=="0") {
                    results[resultsKey] = item["idiom"][j] ;
                    console.log(`answer row(${posObj[1]}) cell(${posObj[0]}) value(${item["idiom"][j]})`)
                }
            }
        }

        for (let i in data) {
            let item = data[i] ;
            let poses = item["pos"].split(";") ;
            for (let j=0,c=item["idiom"].length; j<c; j++) {
                let pos = poses.shift() ;
                let posObj = pos.split(",") ;
                let left = posObj[0]*span ;
                let top = posObj[1]*span ;
                let debug1 = `x=${posObj[0]};y=${posObj[1]}` ;
                let word = "?" ;
                let resultsKey = `${posObj[1]}-${posObj[0]}` ;

                if (results[resultsKey]==undefined) {
                    word = item["idiom"][j];
                }

                let ele = document.createElement("div") ;
                ele.setAttribute("class", "item");
                ele.setAttribute("style", `left: ${left}px; top: ${top}px`);
                ele.setAttribute("debug1", debug1);
                ele.append(word) ;

                document.getElementById("content").appendChild(ele) ;
            }
        }

        return results ;
    }

</script>

</body>
</html>